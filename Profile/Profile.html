<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KMITL Store - Order Form</title>
    <link rel="stylesheet" href="Profile.css">
    <script src="../Components/Navbar.js" defer></script>
    <script src="../Components/Footer.js" defer></script>

</head>


    <!-- ใช้ Web Component ของ Navbar -->
    <my-navbar></my-navbar>


    <div class="logout-icon">
        <a href="../Login/Login.html">
            <img src="../icons/logout-icon.png" alt="Profile Picture" class="profile-picture">
        </a>
    </div>

    <body>
        <div class="profile-container">
            <div class="profile-header">
                <img src="../icons/Profile.jpg" alt="Profile Picture" class="profile-picture">
                <h1>
                    RiSa2020
                    <a href="Profile-Edit.html" class="edit-icon">✏️</a> <!-- เพิ่มลิงค์ไปที่หน้า Edit Profile -->
                </h1>
            </div>
        </div>

        <div class="profile-info">
            <p>ชื่อ นางสาว yanothai</p>
            <p>เบอร์โทรศัพท์ 0XX-XXX-XXXX</p>
            <p>Email: XXXXXXXXXXXX@gmail.com</p>
            <a href="../SellerCentre/Seller-Centre.html">
                <button class="seller-centre-button">+ Seller Centre</button>
            </a>
        </div>

        <div class="transaction-history">
            <h2>ประวัติการซื้อ-ขาย</h2>
            <div class="transactions">
                <!-- ประวัติการซื้อ -->
                <div class="transaction-section">
                    <h3><a href="../history/Purchase-history.html">ประวัติการซื้อ</a></h3>
                    <ul>
                        <li>กระโปรงพลิ้ว... <span class="status">สำเร็จ</span></li>
                        <li>กางเกงสแล็ค... <span class="status">สำเร็จ</span></li>
                        <li>เสื้อรุ่นคณะวิท... <span class="status">สำเร็จ</span></li>
                        <li>เสื้อรุ่นคณะวิท... <span class="status">สำเร็จ</span></li>
                        <li>กระโปรงพลิ้ว... <span class="status">สำเร็จ</span></li>
                    </ul>
                </div>
                <!-- ประวัติการขาย -->
                <div class="transaction-section">
                    <h3><a href="../history/Sales-history.html">ประวัติการขาย</a></h3>
                    <ul>
                        <li>กระโปรงพลิ้ว... <span class="status">สำเร็จ</span></li>
                        <li>กางเกงสแล็ค... <span class="status">สำเร็จ</span></li>
                        <li>เสื้อรุ่นคณะวิท... <span class="status">สำเร็จ</span></li>
                        <li>เสื้อรุ่นคณะวิท... <span class="status">สำเร็จ</span></li>
                        <li>กระโปรงพลิ้ว... <span class="status">สำเร็จ</span></li>
                    </ul>
                </div>
            </div>
        </div>
        </div>
        <script>
    document.addEventListener('DOMContentLoaded', async () => {
        const token = localStorage.getItem('token'); // สมมุติว่าเก็บ token ใน localStorage
        console.log('Token:', token);
        if (!token) {
            alert('กรุณาเข้าสู่ระบบก่อน');
            window.location.href = '../Login/Login.html'; // เปลี่ยนไปที่หน้าเข้าสู่ระบบ
            return;
        }
    
        try {
            const response = await fetch('http://localhost:3000/users', {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}` // ส่ง token ไปกับ request ในรูปแบบ Bearer
        }
        });
        if (!response.ok) {
            if (response.status === 401) {
                alert('Token ไม่ถูกต้อง กรุณาเข้าสู่ระบบใหม่');
                window.location.href = '../Login/Login.html';
            }
            throw new Error('ไม่สามารถดึงข้อมูลผู้ใช้ได้');
        }
        const userData = await response.json();
        // ใส่ข้อมูลที่ดึงมาใน HTML
        document.querySelector('.profile-header h1').textContent = userData.username;
        document.querySelector('.profile-info p:nth-child(1)').textContent = `ชื่อ ${userData.username}`;
        document.querySelector('.profile-info p:nth-child(2)').textContent = `เบอร์โทรศัพท์ ${userData.phone}`;
        document.querySelector('.profile-info p:nth-child(3)').textContent = `Email: ${userData.email}`;
    } catch (error) {
        console.error('Error:', error);
        alert('เกิดข้อผิดพลาดในการดึงข้อมูลผู้ใช้');
    }
});

</script>
        <!-- Use Web Component of Footer -->
        <my-footer></my-footer>

    </body>

</html>